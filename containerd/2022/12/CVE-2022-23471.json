{
	"cvss": {},
	"ghsa_id": "GHSA-2qjp-425j-52j9",
	"summary": "containerd CRI stream server: Host memory exhaustion through Terminal resize goroutine leak",
	"description": "### Impact\r\n\r\nA bug was found in containerd's CRI implementation where a user can exhaust memory on the host. In the CRI stream server, a goroutine is launched to handle terminal resize events if a TTY is requested. If the user's process fails to launch due to, for example, a faulty command, the goroutine will be stuck waiting to send without a receiver, resulting in a memory leak. Kubernetes and crictl can both be configured to use containerd's CRI implementation and the stream server is used for handling container IO.\r\n\r\n### Patches\r\n\r\nThis bug has been fixed in containerd 1.6.12 and 1.5.16.  Users should update to these versions to resolve the issue.\r\n\r\n### Workarounds\r\n\r\nEnsure that only trusted images and commands are used and that only trusted users have permissions to execute commands in running containers. \r\n\r\n### For more information\r\n\r\nIf you have any questions or comments about this advisory:\r\n\r\n* Open an issue in [containerd](https://github.com/containerd/containerd/issues/new/choose)\r\n* Email us at [security@containerd.io](mailto:security@containerd.io)\r\n\r\nTo report a security issue in containerd:\r\n* [Report a new vulnerability](https://github.com/containerd/containerd/security/advisories/new)\r\n* Email us at [security@containerd.io](mailto:security@containerd.io)",
	"severity": "medium",
	"identifiers": [
		{
			"value": "GHSA-2qjp-425j-52j9",
			"type": "GHSA"
		},
		{
			"value": "CVE-2022-23471",
			"type": "CVE"
		}
	],
	"published_at": "2022-12-07T22:47:37Z",
	"updated_at": "2022-12-07T22:47:37Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "go",
				"name": ""
			},
			"vulnerable_version_range": "\u003c 1.5.16, 1.6.0-1.6.11",
			"patched_versions": "1.5.16, 1.6.12"
		}
	],
	"cve_id": "CVE-2022-23471",
	"url": "https://api.github.com/repos/containerd/containerd/security-advisories/GHSA-2qjp-425j-52j9",
	"html_url": "https://github.com/containerd/containerd/security/advisories/GHSA-2qjp-425j-52j9",
	"publisher": {
		"login": "samuelkarp",
		"id": 737750,
		"node_id": "MDQ6VXNlcjczNzc1MA==",
		"avatar_url": "https://avatars.githubusercontent.com/u/737750?v=4",
		"html_url": "https://github.com/samuelkarp",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/samuelkarp",
		"events_url": "https://api.github.com/users/samuelkarp/events{/privacy}",
		"following_url": "https://api.github.com/users/samuelkarp/following{/other_user}",
		"followers_url": "https://api.github.com/users/samuelkarp/followers",
		"gists_url": "https://api.github.com/users/samuelkarp/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/samuelkarp/orgs",
		"received_events_url": "https://api.github.com/users/samuelkarp/received_events",
		"repos_url": "https://api.github.com/users/samuelkarp/repos",
		"starred_url": "https://api.github.com/users/samuelkarp/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/samuelkarp/subscriptions"
	},
	"state": "published"
}