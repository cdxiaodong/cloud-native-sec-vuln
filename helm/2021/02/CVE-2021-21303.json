{
	"cvss": {},
	"ghsa_id": "GHSA-c38g-469g-cmgx",
	"summary": "Unsanitized data displayed directly to user's terminal",
	"description": "During a routine code audit, members of the Helm core maintainers identified a few cases where data loaded from potentially untrusted sources was not properly sanitized.\r\n\r\n- When a SemVer in the `version` field of a chart is invalid, in some cases Helm allows the string to be used \"as is\" without sanitizing.\r\n- Helm fails to properly sanitized some fields present on Helm repository `index.yaml` files.\r\n- Helm does not properly sanitized some fields in the `plugin.yaml` file for plugins\r\n- In some cases, Helm does not properly sanitize the fields in the `Chart.yaml` file\r\n\r\n### Impact\r\n\r\nSince Helm 2 was released, a well-documented aspect of Helm is that the Helm chart's version number MUST follow the SemVer2 specification. In the past, Helm would not permit charts with malformed versions. At some point, a patch was merged that changed this: On a version parse error, the version number was simply passed along as-is. This provided a vector for malicious data to be injected into Helm and potentially used in various ways.\r\n\r\nCore maintainers were able to send deceptive information to a terminal screen running the `helm` command, as well as obscure or alter information on the screen. In some cases, we could send codes that terminals used to execute higher-order logic, like clearing a terminal screen.\r\n\r\nFurther, during evaluation, the Helm maintainers discovered a few other fields that were not properly sanitized when read out of repository index files. This fix remedies all such cases, and once again enforces SemVer2 policies on version fields.\r\n\r\nAll users of the Helm 3 should upgrade.\r\n\r\nThose who use Helm as a library should verify that they either sanitize this data on their own, or use the proper Helm API calls to sanitize the data.\r\n\r\n### Patches\r\nThis issue has been resolved in Helm 3.5.1.\r\n\r\nWhile this fix does not constitute a breaking change, as all field formatting is now enforced as documented, it is possible that charts that were mistakenly allowed (but invalid) may no longer be available in search indexes. Specifically, **malformed SemVer versions are no longer supported**. This has always been the documented case, but it is true that malformed versions were allowed.\r\n\r\nNote that this is the first security release since Helm 2's final deprecation. Helm 2 was not audited for vulnerability to this issue, and should be assumed vulnerable.\r\n\r\n### Workarounds\r\nAs always, we recommend not using un-trusted chart repositories or Helm plugins, nor do we recommend installing charts from unknown sources.\r\n\r\nTo manually audit Helm chart repositories, you can access the `index.yaml` file of the repository and scan it for suspicious characters or formatting. To manually check plugins, unpack the plugin and scan `plugin.yaml` for suspicious formatting or characters. Likewise, for charts, scan `Charts.yaml` for suspicious characters or formatting.\r\n\r\n### References\r\n_Are there any links users can visit to find out more?_\r\n\r\n### For more information\r\nHelm's security policy is spelled out in detail in our [SECURITY](https://github.com/helm/community/blob/master/SECURITY.md) document.\r\n",
	"severity": "low",
	"identifiers": [
		{
			"value": "GHSA-c38g-469g-cmgx",
			"type": "GHSA"
		},
		{
			"value": "CVE-2021-21303",
			"type": "CVE"
		}
	],
	"published_at": "2021-02-04T21:50:55Z",
	"updated_at": "2021-02-05T20:27:41Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "",
				"name": ""
			},
			"vulnerable_version_range": "\u003e3.0 and \u003c 3.5.1",
			"patched_versions": "3.5.1"
		}
	],
	"cve_id": "CVE-2021-21303",
	"url": "https://api.github.com/repos/helm/helm/security-advisories/GHSA-c38g-469g-cmgx",
	"html_url": "https://github.com/helm/helm/security/advisories/GHSA-c38g-469g-cmgx",
	"publisher": {
		"login": "technosophos",
		"id": 89193,
		"node_id": "MDQ6VXNlcjg5MTkz",
		"avatar_url": "https://avatars.githubusercontent.com/u/89193?v=4",
		"html_url": "https://github.com/technosophos",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/technosophos",
		"events_url": "https://api.github.com/users/technosophos/events{/privacy}",
		"following_url": "https://api.github.com/users/technosophos/following{/other_user}",
		"followers_url": "https://api.github.com/users/technosophos/followers",
		"gists_url": "https://api.github.com/users/technosophos/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/technosophos/orgs",
		"received_events_url": "https://api.github.com/users/technosophos/received_events",
		"repos_url": "https://api.github.com/users/technosophos/repos",
		"starred_url": "https://api.github.com/users/technosophos/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/technosophos/subscriptions"
	},
	"state": "published"
}