{
	"cvss": {
		"score": 10,
		"vector_string": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H"
	},
	"cwes": [
		{
			"cwe_id": "CWE-200",
			"name": "Exposure of Sensitive Information to an Unauthorized Actor"
		},
		{
			"cwe_id": "CWE-256",
			"name": "Plaintext Storage of a Password"
		}
	],
	"ghsa_id": "GHSA-8w87-58w6-hfv8",
	"summary": "Failure to properly sanitize credentials in cluster template answers",
	"description": "### Impact\r\n\r\nIt was discovered that in Rancher versions up to and including 2.5.12 and 2.6.3 there is a failure to properly sanitize credentials in cluster template answers. This failure can lead to plaintext storage and exposure of credentials, passwords and API tokens.\r\n\r\nThe exposed credentials are visible in Rancher to authenticated `Cluster Owners`, `Cluster Members`, `Project Owners` and `Project Members` on the endpoints `/v1/management.cattle.io.clusters`, `/v3/clusters` and `/k8s/clusters/local/apis/management.cattle.io/v3/clusters`.\r\n\r\nSensitive fields are now stripped from `Clusters` objects before the object is stored. For objects that existed before this security fix, a one-time migration happens on startup.\r\n\r\n**Important:**\r\n- It is highly advised to review for potential leaked credentials in this scenario, and to change them if deemed necessary.\r\n- The final impact severity for confidentiality, integrity and availability is dependent on the permissions that the leaked credentials have on their own services.\r\n\r\n### Patches\r\nPatched versions include releases 2.5.13, 2.6.4 and later versions.\r\n\r\n### Workarounds\r\nLimit access in Rancher to trusted users. There is not a direct mitigation besides upgrading to the patched Rancher versions.\r\n\r\n**Important:** It is highly advised to review for potential leaked credentials in this scenario, and to change them if deemed necessary.\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n* Reach out to [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy) for security related inquiries.\r\n* Open an issue in [Rancher](https://github.com/rancher/rancher/issues/new/choose) repository.\r\n* Verify our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/) and [product support lifecycle](https://www.suse.com/lifecycle/).",
	"severity": "critical",
	"identifiers": [
		{
			"value": "GHSA-8w87-58w6-hfv8",
			"type": "GHSA"
		},
		{
			"value": "CVE-2021-36783",
			"type": "CVE"
		}
	],
	"published_at": "2022-08-19T03:50:29Z",
	"updated_at": "2022-08-19T03:50:29Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "go",
				"name": "rancher/rancher"
			},
			"vulnerable_version_range": "From 2.5.0 and 2.6.0 up to and including 2.5.12 and 2.6.3",
			"patched_versions": "2.5.13, 2.6.4 and later releases"
		}
	],
	"cve_id": "CVE-2021-36783",
	"url": "https://api.github.com/repos/rancher/rancher/security-advisories/GHSA-8w87-58w6-hfv8",
	"html_url": "https://github.com/rancher/rancher/security/advisories/GHSA-8w87-58w6-hfv8",
	"publisher": {
		"login": "rmweir",
		"id": 19376037,
		"node_id": "MDQ6VXNlcjE5Mzc2MDM3",
		"avatar_url": "https://avatars.githubusercontent.com/u/19376037?v=4",
		"html_url": "https://github.com/rmweir",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/rmweir",
		"events_url": "https://api.github.com/users/rmweir/events{/privacy}",
		"following_url": "https://api.github.com/users/rmweir/following{/other_user}",
		"followers_url": "https://api.github.com/users/rmweir/followers",
		"gists_url": "https://api.github.com/users/rmweir/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/rmweir/orgs",
		"received_events_url": "https://api.github.com/users/rmweir/received_events",
		"repos_url": "https://api.github.com/users/rmweir/repos",
		"starred_url": "https://api.github.com/users/rmweir/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/rmweir/subscriptions"
	},
	"state": "published",
	"cwe_ids": [
		"CWE-200",
		"CWE-256"
	]
}