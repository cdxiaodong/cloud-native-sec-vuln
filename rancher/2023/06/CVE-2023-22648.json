{
	"cvss": {
		"score": 8,
		"vector_string": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H"
	},
	"cwes": [
		{
			"cwe_id": "CWE-285",
			"name": "Improper Authorization"
		}
	],
	"ghsa_id": "GHSA-vf6j-6739-78m8",
	"summary": "Azure AD permission changes are not reflected on active sessions",
	"description": "### Impact\r\nThis issue only affects Rancher instances with Azure AD integration enabled, regardless of the [automatically refreshing settings](https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/manage-users-and-groups#automatically-refreshing-user-information) which are enabled by default. The users that obtained a token (or kubeconfig) to access Rancher through the following sessions are affected by this issue:\r\n1) Users using the Rancher UI.\r\n2) Users using `kubectl` based on a `kubeconfig` downloaded through the Rancher UI.\r\n3) Tokens created via the Rancher UI Create API Key feature.\r\n\r\nA bug has been identified in which permission changes in Azure AD are not reflected to users while they are logged in the Rancher UI. This would cause the users to retain their previous permissions in Rancher, even if they change groups on Azure AD, for example, to a lower privileged group, or are removed from a group, thus retaining their access to Rancher instead of losing it.\r\n\r\nNote that the permission caching is persisted even when the Rancher Manager pod is restarted. The only way for a user to get the new permissions is to logout and login again.\r\n\r\n### Patches\r\nPatched versions include releases `2.6.13`, `2.7.4` and later versions.\r\n\r\n### Workarounds\r\nThere is no direct mitigation besides updating Rancher to a patched version.\r\n\r\n### Credits\r\nWe would like to recognize and thank @yvespp for the responsible disclosure of this security issue.\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n\r\n- Reach out to the [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy) for security related inquiries.\r\n- Open an issue in the [Rancher](https://github.com/rancher/rancher/issues/new/choose) repository.\r\n- Verify with our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/) and [product support lifecycle](https://www.suse.com/lifecycle/).",
	"severity": "high",
	"identifiers": [
		{
			"value": "GHSA-vf6j-6739-78m8",
			"type": "GHSA"
		},
		{
			"value": "CVE-2023-22648",
			"type": "CVE"
		}
	],
	"published_at": "2023-06-01T01:16:02Z",
	"updated_at": "2023-06-01T01:16:02Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "go",
				"name": "rancher/rancher"
			},
			"vulnerable_version_range": "\u003e= 2.6.7, \u003c 2.6.13",
			"patched_versions": "2.6.13"
		},
		{
			"package": {
				"ecosystem": "go",
				"name": "rancher/rancher"
			},
			"vulnerable_version_range": "\u003e= 2.7.0, \u003c 2.7.4",
			"patched_versions": "2.7.4"
		}
	],
	"cve_id": "CVE-2023-22648",
	"url": "https://api.github.com/repos/rancher/rancher/security-advisories/GHSA-vf6j-6739-78m8",
	"html_url": "https://github.com/rancher/rancher/security/advisories/GHSA-vf6j-6739-78m8",
	"publisher": {
		"login": "macedogm",
		"id": 17654553,
		"node_id": "MDQ6VXNlcjE3NjU0NTUz",
		"avatar_url": "https://avatars.githubusercontent.com/u/17654553?v=4",
		"html_url": "https://github.com/macedogm",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/macedogm",
		"events_url": "https://api.github.com/users/macedogm/events{/privacy}",
		"following_url": "https://api.github.com/users/macedogm/following{/other_user}",
		"followers_url": "https://api.github.com/users/macedogm/followers",
		"gists_url": "https://api.github.com/users/macedogm/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/macedogm/orgs",
		"received_events_url": "https://api.github.com/users/macedogm/received_events",
		"repos_url": "https://api.github.com/users/macedogm/repos",
		"starred_url": "https://api.github.com/users/macedogm/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/macedogm/subscriptions"
	},
	"state": "published",
	"cwe_ids": [
		"CWE-285"
	],
	"credits": [
		{
			"login": "yvespp",
			"type": "reporter"
		}
	],
	"credits_detailed": [
		{
			"user": {
				"login": "yvespp",
				"id": 15231595,
				"node_id": "MDQ6VXNlcjE1MjMxNTk1",
				"avatar_url": "https://avatars.githubusercontent.com/u/15231595?v=4",
				"html_url": "https://github.com/yvespp",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/yvespp",
				"events_url": "https://api.github.com/users/yvespp/events{/privacy}",
				"following_url": "https://api.github.com/users/yvespp/following{/other_user}",
				"followers_url": "https://api.github.com/users/yvespp/followers",
				"gists_url": "https://api.github.com/users/yvespp/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/yvespp/orgs",
				"received_events_url": "https://api.github.com/users/yvespp/received_events",
				"repos_url": "https://api.github.com/users/yvespp/repos",
				"starred_url": "https://api.github.com/users/yvespp/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/yvespp/subscriptions"
			},
			"type": "reporter",
			"state": "accepted"
		}
	]
}