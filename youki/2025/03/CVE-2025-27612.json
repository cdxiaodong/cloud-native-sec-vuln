{
	"cvss": {
		"score": 5.9,
		"vector_string": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L"
	},
	"ghsa_id": "GHSA-5w4j-f78p-4wh9",
	"summary": "Libcontainer is affected by capabilities elevation similar to GHSA-f3fp-gc8g-vw66",
	"description": "### Impact\r\nIn libcontainer, while creating a tenant container, the tenant builder accepts a list of capabilities to be added in the spec of tenant container. Code can be seen [here](https://github.com/youki-dev/youki/blob/9e63fa4da1672a78ca45100f3059a732784a5174/crates/libcontainer/src/container/tenant_builder.rs#L408) . The logic here adds the given capabilities to all capabilities of main container if present in spec, otherwise simply set provided capabilities as capabilities of the tenant container.\r\n\r\nHowever, GHSA-f3fp-gc8g-vw66 was opened on runc mentioning that setting inherited caps in any case for tenant container can lead to elevation of capabilities. For this, they added a fix [here](https://github.com/opencontainers/runc/blob/986451c24e17c8d4be3c454f60b1f7be4af3e8b4/exec.go#L234-L242) where they never set new inherited caps on tenant, and set ambient caps only if original container had inherited caps.\r\n\r\nSimilarly crun never sets inherited caps as can be seen [here](https://github.com/containers/crun/blob/3ec6298abd79e144fbf3fa6db90793ff4c0516f9/src/exec.c#L319).\r\n\r\n\u003e [!NOTE]\r\nThis does not affect youki binary itself, as the exec implementation is partially broken and does not pass on the user-provided caps to tenant containers, this is only applicable if you are using libcontainer directly and using the tenant builder.\r\n\r\n### Workarounds\r\n- Do not pass any user-provided capabilities to the tenant builder, in which case no capabilities will be set on tenant.\r\n- Alternatively you can verify the capabilities of original container and filter the user passed capabilities before setting them on tenant.\r\n\r\n### References\r\n- https://github.com/opencontainers/runc/security/advisories/GHSA-f3fp-gc8g-vw66\r\n- https://man7.org/linux/man-pages/man7/capabilities.7.html\r\n",
	"severity": "medium",
	"identifiers": [
		{
			"value": "GHSA-5w4j-f78p-4wh9",
			"type": "GHSA"
		},
		{
			"value": "CVE-2025-27612",
			"type": "CVE"
		}
	],
	"published_at": "2025-03-21T12:33:28Z",
	"updated_at": "2025-03-21T12:33:29Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "rust",
				"name": "libcontainer"
			},
			"vulnerable_version_range": "\u003c0.5.2",
			"patched_versions": "0.5.3"
		}
	],
	"cve_id": "CVE-2025-27612",
	"url": "https://api.github.com/repos/youki-dev/youki/security-advisories/GHSA-5w4j-f78p-4wh9",
	"html_url": "https://github.com/youki-dev/youki/security/advisories/GHSA-5w4j-f78p-4wh9",
	"publisher": {
		"login": "utam0k",
		"id": 13010913,
		"node_id": "MDQ6VXNlcjEzMDEwOTEz",
		"avatar_url": "https://avatars.githubusercontent.com/u/13010913?v=4",
		"html_url": "https://github.com/utam0k",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/utam0k",
		"events_url": "https://api.github.com/users/utam0k/events{/privacy}",
		"following_url": "https://api.github.com/users/utam0k/following{/other_user}",
		"followers_url": "https://api.github.com/users/utam0k/followers",
		"gists_url": "https://api.github.com/users/utam0k/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/utam0k/orgs",
		"received_events_url": "https://api.github.com/users/utam0k/received_events",
		"repos_url": "https://api.github.com/users/utam0k/repos",
		"starred_url": "https://api.github.com/users/utam0k/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/utam0k/subscriptions"
	},
	"state": "published",
	"credits": [
		{
			"login": "YJDoc2",
			"type": "reporter"
		},
		{
			"login": "utam0k",
			"type": "coordinator"
		},
		{
			"login": "jprendes",
			"type": "coordinator"
		}
	],
	"credits_detailed": [
		{
			"user": {
				"login": "YJDoc2",
				"id": 54112038,
				"node_id": "MDQ6VXNlcjU0MTEyMDM4",
				"avatar_url": "https://avatars.githubusercontent.com/u/54112038?v=4",
				"html_url": "https://github.com/YJDoc2",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/YJDoc2",
				"events_url": "https://api.github.com/users/YJDoc2/events{/privacy}",
				"following_url": "https://api.github.com/users/YJDoc2/following{/other_user}",
				"followers_url": "https://api.github.com/users/YJDoc2/followers",
				"gists_url": "https://api.github.com/users/YJDoc2/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/YJDoc2/orgs",
				"received_events_url": "https://api.github.com/users/YJDoc2/received_events",
				"repos_url": "https://api.github.com/users/YJDoc2/repos",
				"starred_url": "https://api.github.com/users/YJDoc2/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/YJDoc2/subscriptions"
			},
			"type": "reporter",
			"state": "accepted"
		},
		{
			"user": {
				"login": "utam0k",
				"id": 13010913,
				"node_id": "MDQ6VXNlcjEzMDEwOTEz",
				"avatar_url": "https://avatars.githubusercontent.com/u/13010913?v=4",
				"html_url": "https://github.com/utam0k",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/utam0k",
				"events_url": "https://api.github.com/users/utam0k/events{/privacy}",
				"following_url": "https://api.github.com/users/utam0k/following{/other_user}",
				"followers_url": "https://api.github.com/users/utam0k/followers",
				"gists_url": "https://api.github.com/users/utam0k/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/utam0k/orgs",
				"received_events_url": "https://api.github.com/users/utam0k/received_events",
				"repos_url": "https://api.github.com/users/utam0k/repos",
				"starred_url": "https://api.github.com/users/utam0k/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/utam0k/subscriptions"
			},
			"type": "coordinator",
			"state": "accepted"
		},
		{
			"user": {
				"login": "jprendes",
				"id": 2564439,
				"node_id": "MDQ6VXNlcjI1NjQ0Mzk=",
				"avatar_url": "https://avatars.githubusercontent.com/u/2564439?v=4",
				"html_url": "https://github.com/jprendes",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/jprendes",
				"events_url": "https://api.github.com/users/jprendes/events{/privacy}",
				"following_url": "https://api.github.com/users/jprendes/following{/other_user}",
				"followers_url": "https://api.github.com/users/jprendes/followers",
				"gists_url": "https://api.github.com/users/jprendes/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/jprendes/orgs",
				"received_events_url": "https://api.github.com/users/jprendes/received_events",
				"repos_url": "https://api.github.com/users/jprendes/repos",
				"starred_url": "https://api.github.com/users/jprendes/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/jprendes/subscriptions"
			},
			"type": "coordinator",
			"state": "accepted"
		}
	]
}