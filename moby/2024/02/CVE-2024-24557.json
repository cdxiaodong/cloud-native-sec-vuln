{
	"cvss": {
		"score": 6.9,
		"vector_string": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:L/I:H/A:L"
	},
	"ghsa_id": "GHSA-xw73-rw38-6vjc",
	"summary": "Classic builder cache poisoning",
	"description": "The classic builder cache system is prone to cache poisoning if the image is built `FROM scratch`.\r\nAlso, changes to some instructions (most important being `HEALTHCHECK` and `ONBUILD`) would not cause a cache miss.\r\n\r\n\r\nAn attacker with the knowledge of the Dockerfile someone is using could poison their cache by making them pull a specially crafted image that would be considered as a valid cache candidate for some build steps.\r\n\r\nFor example, an attacker could create an image that is considered as a valid cache candidate for:\r\n```\r\nFROM scratch\r\nMAINTAINER Pawel\r\n```\r\n\r\nwhen in fact the malicious image used as a cache would be an image built from a different Dockerfile.\r\n\r\nIn the second case, the attacker could for example substitute a different `HEALTCHECK` command.\r\n\r\n\r\n### Impact\r\n\r\n23.0+ users are only affected if they explicitly opted out of Buildkit (`DOCKER_BUILDKIT=0` environment variable) or are using the `/build` API endpoint (which uses the classic builder by default).\r\n\r\nAll users on versions older than 23.0 could be impacted. An example could be a CI with a shared cache, or just a regular Docker user pulling a malicious image due to misspelling/typosquatting.\r\n\r\nImage build API endpoint (`/build`) and `ImageBuild` function from `github.com/docker/docker/client` is also affected as it the uses classic builder by default. \r\n\r\n\r\n### Patches\r\n\r\nPatches are included in Moby releases:\r\n\r\n- v25.0.2\r\n- v24.0.9\r\n- v23.0.10\r\n\r\n### Workarounds\r\n\r\n- Use `--no-cache` or use Buildkit if possible (`DOCKER_BUILDKIT=1`, it's default on 23.0+ assuming that the buildx plugin is installed).\r\n- Use `Version = types.BuilderBuildKit` or `NoCache = true` in `ImageBuildOptions` for `ImageBuild` call.\r\n\r\n",
	"severity": "medium",
	"identifiers": [
		{
			"value": "GHSA-xw73-rw38-6vjc",
			"type": "GHSA"
		},
		{
			"value": "CVE-2024-24557",
			"type": "CVE"
		}
	],
	"published_at": "2024-02-01T03:58:20Z",
	"updated_at": "2024-05-29T18:35:33Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "go",
				"name": "github.com/docker/docker"
			},
			"vulnerable_version_range": "\u003e= v25, \u003c v25.0.2",
			"patched_versions": "\u003e= v25.0.2"
		},
		{
			"package": {
				"ecosystem": "go",
				"name": "github.com/docker/docker"
			},
			"vulnerable_version_range": "\u003e= v24, \u003c v24.0.9",
			"patched_versions": "\u003e= v24.0.9"
		},
		{
			"package": {
				"ecosystem": "go",
				"name": "github.com/docker/docker"
			},
			"vulnerable_version_range": "\u003e= v23, \u003c v23.0.10",
			"patched_versions": "\u003e= v23.0.10"
		}
	],
	"cve_id": "CVE-2024-24557",
	"url": "https://api.github.com/repos/moby/moby/security-advisories/GHSA-xw73-rw38-6vjc",
	"html_url": "https://github.com/moby/moby/security/advisories/GHSA-xw73-rw38-6vjc",
	"publisher": {
		"login": "tonistiigi",
		"id": 585223,
		"node_id": "MDQ6VXNlcjU4NTIyMw==",
		"avatar_url": "https://avatars.githubusercontent.com/u/585223?v=4",
		"html_url": "https://github.com/tonistiigi",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/tonistiigi",
		"events_url": "https://api.github.com/users/tonistiigi/events{/privacy}",
		"following_url": "https://api.github.com/users/tonistiigi/following{/other_user}",
		"followers_url": "https://api.github.com/users/tonistiigi/followers",
		"gists_url": "https://api.github.com/users/tonistiigi/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/tonistiigi/orgs",
		"received_events_url": "https://api.github.com/users/tonistiigi/received_events",
		"repos_url": "https://api.github.com/users/tonistiigi/repos",
		"starred_url": "https://api.github.com/users/tonistiigi/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/tonistiigi/subscriptions"
	},
	"state": "published",
	"credits": [
		{
			"login": "vvoland",
			"type": "finder"
		},
		{
			"login": "rumpl",
			"type": "reporter"
		},
		{
			"login": "gabriellavengeo",
			"type": "remediation_reviewer"
		}
	],
	"credits_detailed": [
		{
			"user": {
				"login": "vvoland",
				"id": 5046555,
				"node_id": "MDQ6VXNlcjUwNDY1NTU=",
				"avatar_url": "https://avatars.githubusercontent.com/u/5046555?v=4",
				"html_url": "https://github.com/vvoland",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/vvoland",
				"events_url": "https://api.github.com/users/vvoland/events{/privacy}",
				"following_url": "https://api.github.com/users/vvoland/following{/other_user}",
				"followers_url": "https://api.github.com/users/vvoland/followers",
				"gists_url": "https://api.github.com/users/vvoland/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/vvoland/orgs",
				"received_events_url": "https://api.github.com/users/vvoland/received_events",
				"repos_url": "https://api.github.com/users/vvoland/repos",
				"starred_url": "https://api.github.com/users/vvoland/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/vvoland/subscriptions"
			},
			"type": "finder",
			"state": "accepted"
		},
		{
			"user": {
				"login": "rumpl",
				"id": 99933,
				"node_id": "MDQ6VXNlcjk5OTMz",
				"avatar_url": "https://avatars.githubusercontent.com/u/99933?v=4",
				"html_url": "https://github.com/rumpl",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/rumpl",
				"events_url": "https://api.github.com/users/rumpl/events{/privacy}",
				"following_url": "https://api.github.com/users/rumpl/following{/other_user}",
				"followers_url": "https://api.github.com/users/rumpl/followers",
				"gists_url": "https://api.github.com/users/rumpl/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/rumpl/orgs",
				"received_events_url": "https://api.github.com/users/rumpl/received_events",
				"repos_url": "https://api.github.com/users/rumpl/repos",
				"starred_url": "https://api.github.com/users/rumpl/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/rumpl/subscriptions"
			},
			"type": "reporter",
			"state": "accepted"
		},
		{
			"user": {
				"login": "gabriellavengeo",
				"id": 23005021,
				"node_id": "MDQ6VXNlcjIzMDA1MDIx",
				"avatar_url": "https://avatars.githubusercontent.com/u/23005021?v=4",
				"html_url": "https://github.com/gabriellavengeo",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/gabriellavengeo",
				"events_url": "https://api.github.com/users/gabriellavengeo/events{/privacy}",
				"following_url": "https://api.github.com/users/gabriellavengeo/following{/other_user}",
				"followers_url": "https://api.github.com/users/gabriellavengeo/followers",
				"gists_url": "https://api.github.com/users/gabriellavengeo/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/gabriellavengeo/orgs",
				"received_events_url": "https://api.github.com/users/gabriellavengeo/received_events",
				"repos_url": "https://api.github.com/users/gabriellavengeo/repos",
				"starred_url": "https://api.github.com/users/gabriellavengeo/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/gabriellavengeo/subscriptions"
			},
			"type": "remediation_reviewer",
			"state": "accepted"
		}
	]
}