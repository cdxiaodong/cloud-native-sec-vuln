{
	"cvss": {},
	"ghsa_id": "GHSA-p4rx-7wvg-fwrc",
	"summary": "Pods can break out of resource confinement on cgroupv2",
	"description": "### Impact\r\n_What kind of vulnerability is it? Who is impacted?_\r\nAll versions of CRI-O running on cgroupv2 nodes. \r\nUnchecked access to an experimental annotation allows a container to be unconfined. Back in 2021, [support was added](https://github.com/cri-o/cri-o/pull/4479) to support an experimental annotation that allows a user to request special resources in cgroupv2. It was supposed to be gated by an experimental annotation: `io.kubernetes.cri-o.UnifiedCgroup`, which was supposed to be filtered from the [list of allowed annotations](https://github.com/cri-o/cri-o/blob/main/pkg/config/workloads.go#L103-L107) . However, there is a bug in this code which allows any user to specify this annotation, regardless of whether it's enabled on the node. The consequences of this are a pod can specify any amount of memory/cpu and get it, circumventing the kubernetes scheduler, and potentially be able to DOS a node. \r\n### Patches\r\n_Has the problem been patched? What versions should users upgrade to?_\r\n1.29.1, 1.28.3, 1.27.3\r\n\r\n### Workarounds\r\n_Is there a way for users to fix or remediate the vulnerability without upgrading?_\r\nuse cgroupv1\r\n\r\n### References\r\n_Are there any links users can visit to find out more?_\r\n",
	"severity": "medium",
	"identifiers": [
		{
			"value": "GHSA-p4rx-7wvg-fwrc",
			"type": "GHSA"
		},
		{
			"value": "CVE-2023-6476",
			"type": "CVE"
		}
	],
	"published_at": "2024-01-09T22:12:57Z",
	"updated_at": "2024-01-09T22:13:14Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "go",
				"name": "CRI-O"
			},
			"vulnerable_version_range": "1.28.2 and lower, 1.27.1 and lower",
			"patched_versions": "v1.29.1, 1.28.3, 1.27.3"
		}
	],
	"cve_id": "CVE-2023-6476",
	"url": "https://api.github.com/repos/cri-o/cri-o/security-advisories/GHSA-p4rx-7wvg-fwrc",
	"html_url": "https://github.com/cri-o/cri-o/security/advisories/GHSA-p4rx-7wvg-fwrc",
	"publisher": {
		"login": "haircommander",
		"id": 9082919,
		"node_id": "MDQ6VXNlcjkwODI5MTk=",
		"avatar_url": "https://avatars.githubusercontent.com/u/9082919?v=4",
		"html_url": "https://github.com/haircommander",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/haircommander",
		"events_url": "https://api.github.com/users/haircommander/events{/privacy}",
		"following_url": "https://api.github.com/users/haircommander/following{/other_user}",
		"followers_url": "https://api.github.com/users/haircommander/followers",
		"gists_url": "https://api.github.com/users/haircommander/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/haircommander/orgs",
		"received_events_url": "https://api.github.com/users/haircommander/received_events",
		"repos_url": "https://api.github.com/users/haircommander/repos",
		"starred_url": "https://api.github.com/users/haircommander/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/haircommander/subscriptions"
	},
	"state": "published",
	"credits": [
		{
			"login": "Tal-or",
			"type": "finder"
		}
	],
	"credits_detailed": [
		{
			"user": {
				"login": "Tal-or",
				"id": 36886869,
				"node_id": "MDQ6VXNlcjM2ODg2ODY5",
				"avatar_url": "https://avatars.githubusercontent.com/u/36886869?v=4",
				"html_url": "https://github.com/Tal-or",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/Tal-or",
				"events_url": "https://api.github.com/users/Tal-or/events{/privacy}",
				"following_url": "https://api.github.com/users/Tal-or/following{/other_user}",
				"followers_url": "https://api.github.com/users/Tal-or/followers",
				"gists_url": "https://api.github.com/users/Tal-or/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/Tal-or/orgs",
				"received_events_url": "https://api.github.com/users/Tal-or/received_events",
				"repos_url": "https://api.github.com/users/Tal-or/repos",
				"starred_url": "https://api.github.com/users/Tal-or/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/Tal-or/subscriptions"
			},
			"type": "finder",
			"state": "accepted"
		}
	]
}