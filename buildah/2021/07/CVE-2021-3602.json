{
	"cvss": {},
	"ghsa_id": "GHSA-7638-r9r3-rmjj",
	"summary": "chroot isolation: environment value leakage to intermediate processes",
	"description": "### Impact\r\nWhen running processes using \"chroot\" isolation, the process being run can examine the environment variables of its immediate parent and grandparent processes (CVE-2021-3602).  This isolation type is often used when running `buildah` in unprivileged containers, and it is often used to do so in CI/CD environments.  If sensitive information is exposed to the original `buildah` process through its environment, that information will unintentionally be shared with child processes which it starts as part of handling RUN instructions or during `buildah run`.  The commands that `buildah` is instructed to run can read that information if they choose to.\r\n\r\n### Patches\r\nUsers should upgrade packages, or images which contain packages, to include version 1.21.3 or later.\r\n\r\n### Workarounds\r\nAs a workaround, invoking `buildah` in a container under `env -i` to have it started with a reinitialized environment should prevent the leakage.\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n* Open an issue in [buildah](https://github.com/containers/buildah/issues)\r\n* Email us at [the buildah general mailing list](mailto:buildah@lists.buildah.io), or [the podman security mailing list](mailto:security@lists.podman.io) if it's sensitive.",
	"severity": "medium",
	"identifiers": [
		{
			"value": "GHSA-7638-r9r3-rmjj",
			"type": "GHSA"
		},
		{
			"value": "CVE-2021-3602",
			"type": "CVE"
		}
	],
	"published_at": "2021-07-15T14:09:46Z",
	"updated_at": "2021-07-15T14:09:46Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "go",
				"name": "github.com/containers/buildah"
			},
			"vulnerable_version_range": "1.21.2, 1.20.0, 1.19.8, 1.18.0, 1.17.1, 1.16.7",
			"patched_versions": "1.21.3, 1.19.9, 1.17.2, 1.16.8"
		}
	],
	"cve_id": "CVE-2021-3602",
	"url": "https://api.github.com/repos/containers/buildah/security-advisories/GHSA-7638-r9r3-rmjj",
	"html_url": "https://github.com/containers/buildah/security/advisories/GHSA-7638-r9r3-rmjj",
	"publisher": {
		"login": "nalind",
		"id": 1200159,
		"node_id": "MDQ6VXNlcjEyMDAxNTk=",
		"avatar_url": "https://avatars.githubusercontent.com/u/1200159?v=4",
		"html_url": "https://github.com/nalind",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/nalind",
		"events_url": "https://api.github.com/users/nalind/events{/privacy}",
		"following_url": "https://api.github.com/users/nalind/following{/other_user}",
		"followers_url": "https://api.github.com/users/nalind/followers",
		"gists_url": "https://api.github.com/users/nalind/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/nalind/orgs",
		"received_events_url": "https://api.github.com/users/nalind/received_events",
		"repos_url": "https://api.github.com/users/nalind/repos",
		"starred_url": "https://api.github.com/users/nalind/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/nalind/subscriptions"
	},
	"state": "published",
	"credits": [
		{
			"login": "bburky",
			"type": "analyst"
		}
	],
	"credits_detailed": [
		{
			"user": {
				"login": "bburky",
				"id": 140526,
				"node_id": "MDQ6VXNlcjE0MDUyNg==",
				"avatar_url": "https://avatars.githubusercontent.com/u/140526?v=4",
				"html_url": "https://github.com/bburky",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/bburky",
				"events_url": "https://api.github.com/users/bburky/events{/privacy}",
				"following_url": "https://api.github.com/users/bburky/following{/other_user}",
				"followers_url": "https://api.github.com/users/bburky/followers",
				"gists_url": "https://api.github.com/users/bburky/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/bburky/orgs",
				"received_events_url": "https://api.github.com/users/bburky/received_events",
				"repos_url": "https://api.github.com/users/bburky/repos",
				"starred_url": "https://api.github.com/users/bburky/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/bburky/subscriptions"
			},
			"type": "analyst",
			"state": "accepted"
		}
	]
}