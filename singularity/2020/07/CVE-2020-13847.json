{
	"cvss": {},
	"ghsa_id": "GHSA-m7j2-9565-4h9v",
	"summary": "SIF Descriptor/Global Header Fields Not Signed",
	"description": "### Impact\r\n\r\nIn Singularity 3.x versions below 3.6.0, Singularity's sign and verify commands do not sign metadata found in the global header or data object descriptors of a SIF file, allowing an attacker to cause unexpected behavior. A signed container may verify successfully, even when it has been modified in ways that could be exploited to cause malicious behavior.\r\n\r\nA container will still verify successfully if:\r\n\r\n * Partition types are changed after signing, e.g. swapping a `PartPrimSys` and `PartOverlay` to modify runtime behavior\r\n * The global hash-bang header used for direct execution (e.g. `./image.sif`) is changed to something else (e.g. `rm -fr $HOME`)\r\n\r\nOther potentially exploitable ways in which a container can be modified, but would still verify successfully include:\r\n\r\n * Re-labelling object data types to change how Singularity uses them. For example, re-labelling DataSignature to avoid the object being considered by singularity verify, DataEnvVar to avoid environment variables being applied, etc.\r\n * Re-labelling partition types, in addition to the example above to change the primary system partition, change data partition to system partition, etc.\r\n * Modifying filesystem types, FsSquash-\u003eFsExt3, causing mount to attempt to mount the wrong type of filesystem.\r\n * Modifying the UID/GID of the image or its data objects.\r\n * Modifying the creation time of the image or its data objects.\r\n * Modifying the name of data objects.\r\n * Modifying the UUID of an image.\r\n\r\n### Patches\r\n\r\nA new signature format that addresses this issue by signing over security critical portions of the global header and object descriptors is introduced in Singularity 3.6.0.\r\n\r\nAll users are advised to upgrade to 3.6.0. Note that the new format is necessarily incompatible with Singularity \u003c 3.6.0 - e.g. Singularity 3.5.3 cannot verify containers signed by 3.6.0.\r\n\r\nVersion 3.6.0 includes a `--legacy-insecure` flag for the `singularity verify` command, that will perform verification of the older, and insecure, legacy signatures for compatibility with existing containers. Verification with the `--legacy-insecure` flag does not indicate a container is unmodified from the time of signing. You should migrate to the new signature format as soon as possible.\r\n\r\n### Workarounds\r\n\r\nIf you do not use SIF images (i.e. only use sandbox containers), you are not affected by this advisory as sign/verify functionality applies to SIF images only.\r\n\r\nIf you cannot update to 3.6.0 at this time you should avoid using `singularity sign`, `singularity verify` or the execution control list functionality (`ecl.toml`), and should consider these features unsafe. \r\n\r\n### For more information\r\n\r\nGeneral questions about the impact of the advisory / changes made in the 3.6.0 release can be asked in the:\r\n\r\n* [Singularity Slack Channel](https://bit.ly/2m0g3lX)\r\n* [Singularity Mailing List](https://groups.google.com/a/lbl.gov/forum/??sdf%7Csort:date#!forum/singularity)\r\n\r\nAny sensitive security concerns should be directed to: security@sylabs.io\r\n\r\nSee our Security Policy here: https://sylabs.io/security-policy\r\n",
	"severity": "high",
	"identifiers": [
		{
			"value": "GHSA-m7j2-9565-4h9v",
			"type": "GHSA"
		},
		{
			"value": "CVE-2020-13847",
			"type": "CVE"
		}
	],
	"published_at": "2020-07-14T14:02:17Z",
	"updated_at": "2020-07-14T14:02:17Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "",
				"name": "singularity"
			},
			"vulnerable_version_range": "All 3.x \u003c3.6.0",
			"patched_versions": "3.6.0"
		}
	],
	"cve_id": "CVE-2020-13847",
	"url": "https://api.github.com/repos/apptainer/singularity/security-advisories/GHSA-m7j2-9565-4h9v",
	"html_url": "https://github.com/apptainer/singularity/security/advisories/GHSA-m7j2-9565-4h9v",
	"publisher": {
		"login": "dtrudg",
		"id": 4522799,
		"node_id": "MDQ6VXNlcjQ1MjI3OTk=",
		"avatar_url": "https://avatars.githubusercontent.com/u/4522799?v=4",
		"html_url": "https://github.com/dtrudg",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/dtrudg",
		"events_url": "https://api.github.com/users/dtrudg/events{/privacy}",
		"following_url": "https://api.github.com/users/dtrudg/following{/other_user}",
		"followers_url": "https://api.github.com/users/dtrudg/followers",
		"gists_url": "https://api.github.com/users/dtrudg/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/dtrudg/orgs",
		"received_events_url": "https://api.github.com/users/dtrudg/received_events",
		"repos_url": "https://api.github.com/users/dtrudg/repos",
		"starred_url": "https://api.github.com/users/dtrudg/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/dtrudg/subscriptions"
	},
	"state": "published",
	"credits": [
		{
			"login": "tri-adam",
			"type": "analyst"
		}
	],
	"credits_detailed": [
		{
			"user": {
				"login": "tri-adam",
				"id": 9903835,
				"node_id": "MDQ6VXNlcjk5MDM4MzU=",
				"avatar_url": "https://avatars.githubusercontent.com/u/9903835?v=4",
				"html_url": "https://github.com/tri-adam",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/tri-adam",
				"events_url": "https://api.github.com/users/tri-adam/events{/privacy}",
				"following_url": "https://api.github.com/users/tri-adam/following{/other_user}",
				"followers_url": "https://api.github.com/users/tri-adam/followers",
				"gists_url": "https://api.github.com/users/tri-adam/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/tri-adam/orgs",
				"received_events_url": "https://api.github.com/users/tri-adam/received_events",
				"repos_url": "https://api.github.com/users/tri-adam/repos",
				"starred_url": "https://api.github.com/users/tri-adam/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/tri-adam/subscriptions"
			},
			"type": "analyst",
			"state": "accepted"
		}
	]
}