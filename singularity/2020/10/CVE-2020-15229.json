{
	"cvss": {},
	"ghsa_id": "GHSA-7gcp-w6ww-2xv9",
	"summary": "Path traversal and files overwrite with unsquashfs",
	"description": "### Impact\r\n\r\nDue to insecure handling of path traversal and the lack of path sanitization within `unsquashfs` (a distribution provided utility used by Singularity), it is possible to overwrite/create any files on the host filesystem during the extraction of a crafted squashfs filesystem.\r\n\r\nSquashfs extraction occurs automatically for unprivileged execution of Singularity (either `--without-suid` installation or with `allow setuid = no`) when a user attempts to run an image which:\r\n\r\n- is a local SIF image or a single file containing a squashfs filesystem\r\n- is pulled from remote sources `library://` or `shub://`\r\n\r\nImage build is also impacted in a more serious way as it is often performed by the root user, allowing an attacker to overwrite/create files leading to a system compromise.  Bootstrap methods `library`, `shub` and `localimage` trigger a squashfs extraction.\r\n\r\n### CVSS\r\n\r\nScore: 8.2 (High)\r\nString: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:N\r\n\r\n### Patches\r\n\r\nThis issue is addressed in Singularity 3.6.4.\r\n\r\nAll users are advised to upgrade to 3.6.4 especially if they use Singularity mainly for building image as root user.\r\n\r\n### Workarounds\r\n\r\nThere is no solid workaround except to temporarily avoid use of unprivileged mode with single file images, in favor of sandbox images instead. Regarding image build, temporarily avoid building from `library` and `shub` sources, and as much as possible use `--fakeroot` or a VM to limit potential impact.\r\n\r\n### For more information\r\n\r\nGeneral questions about the impact of the advisory / changes made in the 3.6.0 release can be asked in the:\r\n\r\n* [Singularity Slack Channel](https://bit.ly/2m0g3lX)\r\n* [Singularity Mailing List](https://groups.google.com/a/lbl.gov/forum/??sdf%7Csort:date#!forum/singularity)\r\n\r\nAny sensitive security concerns should be directed to: security@sylabs.io\r\n\r\nSee our Security Policy here: https://sylabs.io/security-policy",
	"severity": "high",
	"identifiers": [
		{
			"value": "GHSA-7gcp-w6ww-2xv9",
			"type": "GHSA"
		},
		{
			"value": "CVE-2020-15229",
			"type": "CVE"
		}
	],
	"published_at": "2020-10-13T13:50:42Z",
	"updated_at": "2020-10-13T13:50:42Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "",
				"name": "singularity"
			},
			"vulnerable_version_range": "3.1.1 - 3.6.3",
			"patched_versions": "3.6.4"
		}
	],
	"cve_id": "CVE-2020-15229",
	"url": "https://api.github.com/repos/apptainer/singularity/security-advisories/GHSA-7gcp-w6ww-2xv9",
	"html_url": "https://github.com/apptainer/singularity/security/advisories/GHSA-7gcp-w6ww-2xv9",
	"publisher": {
		"login": "dtrudg",
		"id": 4522799,
		"node_id": "MDQ6VXNlcjQ1MjI3OTk=",
		"avatar_url": "https://avatars.githubusercontent.com/u/4522799?v=4",
		"html_url": "https://github.com/dtrudg",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/dtrudg",
		"events_url": "https://api.github.com/users/dtrudg/events{/privacy}",
		"following_url": "https://api.github.com/users/dtrudg/following{/other_user}",
		"followers_url": "https://api.github.com/users/dtrudg/followers",
		"gists_url": "https://api.github.com/users/dtrudg/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/dtrudg/orgs",
		"received_events_url": "https://api.github.com/users/dtrudg/received_events",
		"repos_url": "https://api.github.com/users/dtrudg/repos",
		"starred_url": "https://api.github.com/users/dtrudg/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/dtrudg/subscriptions"
	},
	"state": "published",
	"credits": [
		{
			"login": "cclerget",
			"type": "analyst"
		}
	],
	"credits_detailed": [
		{
			"user": {
				"login": "cclerget",
				"id": 3274134,
				"node_id": "MDQ6VXNlcjMyNzQxMzQ=",
				"avatar_url": "https://avatars.githubusercontent.com/u/3274134?v=4",
				"html_url": "https://github.com/cclerget",
				"gravatar_id": "",
				"type": "User",
				"site_admin": false,
				"url": "https://api.github.com/users/cclerget",
				"events_url": "https://api.github.com/users/cclerget/events{/privacy}",
				"following_url": "https://api.github.com/users/cclerget/following{/other_user}",
				"followers_url": "https://api.github.com/users/cclerget/followers",
				"gists_url": "https://api.github.com/users/cclerget/gists{/gist_id}",
				"organizations_url": "https://api.github.com/users/cclerget/orgs",
				"received_events_url": "https://api.github.com/users/cclerget/received_events",
				"repos_url": "https://api.github.com/users/cclerget/repos",
				"starred_url": "https://api.github.com/users/cclerget/starred{/owner}{/repo}",
				"subscriptions_url": "https://api.github.com/users/cclerget/subscriptions"
			},
			"type": "analyst",
			"state": "accepted"
		}
	]
}