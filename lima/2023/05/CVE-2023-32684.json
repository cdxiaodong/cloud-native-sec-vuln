{
	"cvss": {
		"score": 2.7,
		"vector_string": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:L/I:N/A:N"
	},
	"ghsa_id": "GHSA-f7qw-jj9c-rpq9",
	"summary": "A malicious disk image could read a single file on the host filesystem as a qcow2/vmdk backing file",
	"description": "\u003e **Note**\r\n\u003e\r\n\u003e The official templates of Lima, and the well-known third party products (Colima, Rancher Desktop, and Finch) are *unlikely* to be affected by this issue.\r\n\r\n### Impact\r\nA virtual machine instance with a malicious disk image could read a single file on the host filesystem, even when no filesystem is mounted from the host.\r\n\r\nTo exploit this issue, the attacker has to embed the target file path (an absolute or a relative path from the instance directory) in a malicious disk image, as the [qcow2 (or vmdk) backing file path string](https://gitlab.com/qemu-project/qemu/-/blob/v8.0.0/docs/interop/qcow2.txt#L23-L34).\r\nAs Lima refuses to run as the root, it is practically impossible for the attacker to read the entire host disk via `/dev/rdiskN`.\r\nAlso, practically, the attacker cannot read at least the first 512 bytes (MBR) of the target file.\r\n\r\n### Patches\r\nPatched in Lima v0.16.0, by prohibiting using a backing file path in the VM base image.\r\n\r\n### Workarounds\r\nDo not use an untrusted disk image.",
	"severity": "low",
	"identifiers": [
		{
			"value": "GHSA-f7qw-jj9c-rpq9",
			"type": "GHSA"
		},
		{
			"value": "CVE-2023-32684",
			"type": "CVE"
		}
	],
	"published_at": "2023-05-30T06:25:19Z",
	"updated_at": "2023-05-30T06:25:19Z",
	"vulnerabilities": [
		{
			"package": {
				"ecosystem": "homebrew",
				"name": "lima"
			},
			"vulnerable_version_range": "\u003c 0.16.0",
			"patched_versions": "0.16.0"
		}
	],
	"cve_id": "CVE-2023-32684",
	"url": "https://api.github.com/repos/lima-vm/lima/security-advisories/GHSA-f7qw-jj9c-rpq9",
	"html_url": "https://github.com/lima-vm/lima/security/advisories/GHSA-f7qw-jj9c-rpq9",
	"publisher": {
		"login": "AkihiroSuda",
		"id": 9248427,
		"node_id": "MDQ6VXNlcjkyNDg0Mjc=",
		"avatar_url": "https://avatars.githubusercontent.com/u/9248427?v=4",
		"html_url": "https://github.com/AkihiroSuda",
		"gravatar_id": "",
		"type": "User",
		"site_admin": false,
		"url": "https://api.github.com/users/AkihiroSuda",
		"events_url": "https://api.github.com/users/AkihiroSuda/events{/privacy}",
		"following_url": "https://api.github.com/users/AkihiroSuda/following{/other_user}",
		"followers_url": "https://api.github.com/users/AkihiroSuda/followers",
		"gists_url": "https://api.github.com/users/AkihiroSuda/gists{/gist_id}",
		"organizations_url": "https://api.github.com/users/AkihiroSuda/orgs",
		"received_events_url": "https://api.github.com/users/AkihiroSuda/received_events",
		"repos_url": "https://api.github.com/users/AkihiroSuda/repos",
		"starred_url": "https://api.github.com/users/AkihiroSuda/starred{/owner}{/repo}",
		"subscriptions_url": "https://api.github.com/users/AkihiroSuda/subscriptions"
	},
	"state": "published"
}