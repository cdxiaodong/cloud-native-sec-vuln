{
	"_kubernetes_io": {
		"updated_at": "0001-01-01T00:00:00Z",
		"google_group_url": "https://groups.google.com/g/kubernetes-announce/search?q=CVE-2025-7342",
		"issue_number": 133115
	},
	"content_text": "CVSS Rating High 7.5: [CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H)\n\nA security issue was discovered in the Kubernetes Image Builder where default credentials are enabled during the image build process. Additionally, virtual machine images built using the Nutanix or the OVA provider do not disable these default credentials, and nodes using the resulting images may be accessible via these default credentials. The credentials can be used to gain root access. Kubernetes clusters are only affected if their Windows nodes use VM images created via the Image Builder project with its Nutanix or OVA provider. \n\n### Am I vulnerable?\n\nClusters using virtual machine Windows images built with Kubernetes Image Builder (https://github.com/kubernetes-sigs/image-builder) version v0.1.44 or earlier are affected if built with the Nutanix or OVA provider.\n\nVMs using images built with all other providers are not affected by this issue.\n\nTo determine the version of Image Builder you are using, use one of the following methods:\n- For git clones of the image builder repository:\n```\n    cd \u003clocal path to image builder repo\u003e\n    make version\n```\n- For installations using a tarball download:\n```\n    cd \u003clocal path to install location\u003e\n    grep -o v0\\\\.[0-9.]* RELEASE.md | head -1\n```\n- For a container image release:\n    `docker run --rm \u003cimage pull spec\u003e version`\n  or\n    `podman run --rm \u003cimage pull spec\u003e version`\n  or look at the image tag specified, in the case of an official image such as `registry.k8s.io/scl-image-builder/cluster-node-image-builder-amd64:v0.1.44`\n\n\n#### Affected Versions\n\n- Kubernetes Image Builder versions \u003c= v0.1.44\n\n### How do I mitigate this vulnerability?\nRebuild any affected images using a fixed version of Image Builder. Fixed in Kubernetes Image Builder release v0.1.45\nRe-deploy the fixed images to any affected VMs or use image-builder v0.1.41 (February 2025) or later, and set the `admin_password` JSON variable.\nPrior to upgrading, this vulnerability can be mitigated by changing the password of the Administrator account on affected VMs:\n`net user Administrator \u003cnew-password\u003e`\n\n#### Fixed Versions\n\nFixed in Kubernetes Image Builder release v0.1.45 https://github.com/kubernetes-sigs/image-builder/pull/1800\n\n\n### Detection\n\n`Get-LocalUser -Name Administrator | Select-Object Name,Enabled,SID,Lastlogon | Format-List`\n\nIf you find evidence that this vulnerability has been exploited, please contact security@kubernetes.io\n\n## Additional Details\n\nThe fixed version requires users to specify a password in the WINDOWS_ADMIN_PASSWORD environment variable or in the `admin_password` JSON variable. If both are empty, then the image builder would not build the image and return an error.\n\n#### Acknowledgements\n\nThis vulnerability was reported by Abdel Adim Oisfi, Davide Silvetti, Nicolò Daprelà, Paolo Cavaglià, Pietro Tirenna from Shielder.\n\nThe issue was fixed and coordinated by Matt Boersma of the Image Builder project.\n\n/area security\n/kind bug\n/committee security-response\n/label official-cve-feed\n/sig cluster-lifecycle\n",
	"date_published": "2025-07-21T23:22:19Z",
	"external_url": "https://www.cve.org/cverecord?id=CVE-2025-7342",
	"id": "CVE-2025-7342",
	"status": "open",
	"summary": "VM images built with Kubernetes Image Builder Nutanix or OVA providers use default credentials for Windows images if user did not override",
	"url": "https://github.com/kubernetes/kubernetes/issues/133115"
}