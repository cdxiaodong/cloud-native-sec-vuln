{
	"_kubernetes_io": {
		"updated_at": "0001-01-01T00:00:00Z",
		"google_group_url": "https://groups.google.com/g/kubernetes-announce/search?q=CVE-2023-5043",
		"issue_number": 126816
	},
	"content_text": "### Issue Details\r\n\r\nA security issue was identified in [ingress-nginx](https://github.com/kubernetes/ingress-nginx) where the nginx.ingress.kubernetes.io/configuration-snippet annotation on an Ingress object (in the `networking.k8s.io` or `extensions` API group) can be used to inject arbitrary commands, and obtain the credentials of the ingress-nginx controller. In the default configuration, that credential has access to all secrets in the cluster.\r\n\r\nThis issue has been rated **High** ([CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L)), and assigned **CVE-2023-5043**.\r\n\r\n### Affected Components and Configurations\r\nThis bug affects ingress-nginx. If you do not have ingress-nginx installed on your cluster, you are not affected. You can check this by running `kubectl get po -n ingress-nginx`.\r\n\r\nIf you are running the “chrooted” ingress-nginx controller introduced in v1.2.0 (gcr.io/k8s-staging-ingress-nginx/controller-chroot), command execution is possible but credential extraction is not, so the High severity does not apply.\r\n\r\nMulti-tenant environments where non-admin users have permissions to create Ingress objects are most affected by this issue.\r\n\r\n#### Affected Versions\r\n\r\n- \u003cv1.9.0\r\n\r\n#### Versions allowing mitigation\r\n\r\n- v1.9.0\r\n\r\n### Mitigation\r\nIngress Administrators should set the --enable-annotation-validation flag to enforce restrictions on the contents of ingress-nginx annotation fields.\r\n\r\n### Detection\r\nIf you find evidence that this vulnerability has been exploited, please contact [security@kubernetes.io](mailto:security@kubernetes.io)\r\n\r\n### Additional Details\r\nSee ingress-nginx Issue[ kubernetes/kubernetes#126816](https://github.com/kubernetes/kubernetes/issues/126816) for more details.\r\n\r\n### Acknowledgements\r\nThis vulnerability was reported by suanve\r\n\r\nThank You,\r\nCJ Cullen on behalf of the Kubernetes Security Response Committee",
	"date_published": "2023-10-25T15:48:20Z",
	"external_url": "https://www.cve.org/cverecord?id=CVE-2023-5043",
	"id": "CVE-2023-5043",
	"status": "fixed",
	"summary": "Ingress nginx annotation injection causes arbitrary command execution",
	"url": "https://github.com/kubernetes/kubernetes/issues/126816"
}