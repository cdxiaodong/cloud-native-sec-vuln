{
	"_kubernetes_io": {
		"updated_at": "0001-01-01T00:00:00Z",
		"google_group_url": "https://groups.google.com/g/kubernetes-announce/search?q=CVE-2022-4886",
		"issue_number": 126815
	},
	"content_text": "### Issue Details\r\nA security issue was discovered in [ingress-nginx](https://github.com/kubernetes/ingress-nginx) where a user that can create or update ingress objects can use directives to bypass the sanitization of the `spec.rules[].http.paths[].path` field of an Ingress object (in the `networking.k8s.io` or `extensions` API group) to obtain the credentials of the ingress-nginx controller. In the default configuration, that credential has access to all secrets in the cluster.\r\n\r\nThis issue has been rated **High** ([CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)), and assigned CVE-2022-4886.\r\n\r\n### Affected Components and Configurations\r\nThis bug affects ingress-nginx. If you do not have ingress-nginx installed on your cluster, you are not affected. You can check this by running `kubectl get po -n ingress-nginx`.\r\n\r\nIf you are running the “chrooted” ingress-nginx controller introduced in v1.2.0 (gcr.io/k8s-staging-ingress-nginx/controller-chroot), command execution is possible but credential extraction is not, so the High severity does not apply.\r\n\r\nMulti-tenant environments where non-admin users have permissions to create Ingress objects are most affected by this issue.\r\n\r\n#### Affected Versions\r\n\r\n- \u003cv1.8.0\r\n\r\n#### Versions allowing mitigation\r\n\r\n- v1.8.0\r\n\r\n### Mitigation\r\nIngress objects contain a field called pathType that defines the proxy behavior. It can be Exact, Prefix and ImplementationSpecific.\r\n\r\nWhen pathType is configured as Exact or Prefix, there is more strict validation, allowing only paths starting with \"/\" and containing only alphanumeric characters and \"-\", \"_\" and additional \"/\".\r\n\r\nWhen this option is enabled, the validation happens in the Admission Webhook, denying creation of any Ingress containing invalid characters (unless pathType is ImplementationSpecific).\r\n\r\nhttps://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/#strict-validate-path-type\r\n\r\nIngress Admins should enable this validation by default. If you still need to allow implementation specific paths due to the usage of features like Regex/rewrite on path, we recommend implementing countermeasures to allow just trusted users to consume this feature, as an example with OPA: https://kubernetes.github.io/ingress-nginx/examples/openpolicyagent/\r\n\r\n### Detection\r\nIf you find evidence that this vulnerability has been exploited, please contact [security@kubernetes.io](mailto:security@kubernetes.io)\r\n\r\n### Additional Details\r\nSee ingress-nginx Issue [#10570](https://github.com/kubernetes/kubernetes/issues/126815) for more details.\r\n\r\n### Acknowledgements\r\nThis vulnerability was reported by Ginoah, working with the DEVCORE Internship Program.\r\n\r\nThank You,\r\nCJ Cullen on behalf of the Kubernetes Security Response Committee",
	"date_published": "2023-10-25T15:48:08Z",
	"external_url": "https://www.cve.org/cverecord?id=CVE-2022-4886",
	"id": "CVE-2022-4886",
	"status": "fixed",
	"summary": "ingress-nginx path sanitization can be bypassed",
	"url": "https://github.com/kubernetes/kubernetes/issues/126815"
}