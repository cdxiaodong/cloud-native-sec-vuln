{
	"_kubernetes_io": {
		"updated_at": "0001-01-01T00:00:00Z",
		"google_group_url": "https://groups.google.com/g/kubernetes-announce/search?q=CVE-2024-10220",
		"issue_number": 128885
	},
	"content_text": "A security vulnerability was discovered in Kubernetes that could allow a user with the ability to create a pod and associate a gitRepo volume to execute arbitrary commands beyond the container boundary. This vulnerability leverages the hooks folder in the target repository to run arbitrary commands outside of the container's boundary.\r\n\r\nPlease note that this issue was originally publicly disclosed with a fix in July (#124531), and we are retroactively assigning it a CVE to assist in awareness and tracking.\r\n\r\nThis issue has been rated High ([CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N)) (score: 8.1), and assigned CVE-2024-10220.\r\n\r\n### Am I vulnerable?\r\n\r\nThis CVE affects Kubernetes clusters where pods use the in-tree gitRepo volume to clone a repository to a subdirectory. If the Kubernetes cluster is running one of the affected versions listed below, then it is vulnerable to this issue.\r\n\r\n#### Affected Versions\r\n\r\n- kubelet v1.30.0 to v1.30.2\r\n- kubelet v1.29.0 to v1.29.6\r\n- kubelet \u003c= v1.28.11\r\n\r\n### How do I mitigate this vulnerability?\r\n\r\nTo mitigate this vulnerability, you must upgrade your Kubernetes cluster to one of the fixed versions listed below. \r\n\r\nAdditionally, since the gitRepo volume has been deprecated, the recommended solution is to perform the Git clone operation using an init container and then mount the directory into the Pod's container. An example of this approach is provided [here](https://gist.github.com/tallclair/849601a16cebeee581ef2be50c351841).\r\n\r\n#### Fixed Versions\r\n\r\n* kubelet master/v1.31.0  - fixed by #124531\r\n* kubelet v1.30.3  - fixed by #125988\r\n* kubelet v1.29.7 - fixed by #125989\r\n* kubelet v1.28.12 - fixed by #125990\r\n\r\n### Detection\r\n\r\nTo detect whether this vulnerability has been exploited, you can use the following command to list all pods that use the in-tree gitRepo volume and clones to a .git subdirectory. \r\n\r\n```\r\nkubectl get pods --all-namespaces -o json | jq '.items[] | select(.spec.volumes[].gitRepo.directory | endswith(\"/.git\")) | {name: .metadata.name, namespace: .metadata.namespace}\r\n```\r\n\r\nIf you find evidence that this vulnerability has been exploited, please contact security@kubernetes.io\r\n\r\n#### Acknowledgements\r\n\r\nThis vulnerability was reported and mitigated by Imre Rad.\r\n\r\n/area security\r\n/kind bug\r\n/committee security-response\r\n/label official-cve-feed\r\n/sig node\r\n/area kubelet",
	"date_published": "2024-11-20T15:30:44Z",
	"external_url": "https://www.cve.org/cverecord?id=CVE-2024-10220",
	"id": "CVE-2024-10220",
	"status": "fixed",
	"summary": "Arbitrary command execution through gitRepo volume",
	"url": "https://github.com/kubernetes/kubernetes/issues/128885"
}