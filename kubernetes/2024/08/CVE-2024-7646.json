{
	"_kubernetes_io": {
		"updated_at": "0001-01-01T00:00:00Z",
		"google_group_url": "https://groups.google.com/g/kubernetes-announce/search?q=CVE-2024-7646",
		"issue_number": 126744
	},
	"content_text": "CVSS Rating: [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)\r\n\r\nA security issue was discovered in ingress-nginx where an actor with permission to create Ingress objects (in the `networking.k8s.io` or `extensions` API group) can bypass annotation validation to inject arbitrary commands and obtain the credentials of the ingress-nginx controller. In the default configuration, that credential has access to all secrets in the cluster.\r\n\r\nThis issue has been rated **High** (8.8) [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) and assigned **CVE-2024-7646**.\r\n\r\n### Am I vulnerable?\r\n\r\nThis bug affects ingress-nginx. If you do not have ingress-nginx installed on your cluster, you are not affected. You can check this by running `kubectl get po -A` and looking for `ingress-nginx-controller`.\r\n\r\nMulti-tenant environments where non-admin users have permissions to create Ingress objects are most affected by this issue.\r\n\r\n### Affected Versions\r\n\r\ningress-nginx controller \u003c v1.11.2\r\ningress-nginx controller \u003c v1.10.4\r\n\r\n### How do I mitigate this vulnerability?\r\n\r\nThis issue can be mitigated by upgrading to the fixed version. \r\n\r\n### Fixed Versions\r\n\r\ningress-nginx controller v1.11.2 - fixed by https://github.com/kubernetes/ingress-nginx/pull/11719 and https://github.com/kubernetes/ingress-nginx/pull/11721\r\ningress-nginx controller v1.10.4 - fixed by https://github.com/kubernetes/ingress-nginx/pull/11718 and https://github.com/kubernetes/ingress-nginx/pull/11722\r\n\r\n### Detection\r\n\r\nReview your Kubernetes audit logs for Ingress objects created with annotations (e.g. `nginx.ingress.kubernetes.io/auth-tls-verify-client`) that contain carriage returns (`\\r`).\r\n\r\nIf you find evidence that this vulnerability has been exploited, please contact [security@kubernetes.io](mailto:security@kubernetes.io)\r\n\r\n### Additional Details\r\n\r\nSee the GitHub issue for more details: \r\nhttps://github.com/kubernetes/kubernetes/issues/126744 \r\n\r\n#### Acknowledgements\r\n\r\nThis vulnerability was reported by André Storfjord Kristiansen @dev-bio. \r\n\r\nThe issue was fixed and coordinated by the fix team:\r\nAndré Storfjord Kristiansen @dev-bio\r\nJintao Zhang @tao12345666333\r\nMarco Ebert @Gacko\r\n\r\n/triage accepted\r\n/lifecycle frozen\r\n/area security\r\n/kind bug\r\n/committee security-response",
	"date_published": "2024-08-16T16:10:31Z",
	"external_url": "https://www.cve.org/cverecord?id=CVE-2024-7646",
	"id": "CVE-2024-7646",
	"status": "fixed",
	"summary": "Ingress-nginx Annotation Validation Bypass",
	"url": "https://github.com/kubernetes/kubernetes/issues/126744"
}